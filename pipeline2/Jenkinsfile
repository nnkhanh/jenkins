node {
	
	stage ('Checkout') {
		checkout scmGit(branches: [[name: 'main']],
                userRemoteConfigs: [
                    [ url: 'https://github.com/nnkhanh/publishRepo.git' ]
                ])
	}
	
	stage ('Apply') {
		dir('dc11-dot-khanh-networking') {
			sh 'terraform apply -auto-approve'
		}		
	}

	stage ('Destroy') {
		dir('dc11-dot-khanh-networking') {
			sh 'terraform destroy -auto-approve'
		}		
	}

	stage ('cleanup') {
		cleanWs()
	}
}
